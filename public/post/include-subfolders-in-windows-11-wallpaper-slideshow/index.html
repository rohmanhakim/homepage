<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Include Subfolders in Windows 11 Wallpaper Slideshow | Arif&#39;s Homepage</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css">
<div class="header-container">
  <h1><a href="/">Arif's Homepage</a></h1>
  <ul>
    <li>
      <a href="/projects">Projects</a>
    </li>
    <li>
      <a href="/about">About</a>
    </li>
  </ul>
  <button id="btn-switch-theme">Switch to dark Theme</button>
</div>
  </head>

  <body>
    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Include Subfolders in Windows 11 Wallpaper Slideshow</span></h1>

</div>

<main>
<p>Windows 11 has a feature that enables us to change desktop wallpapers at specified intervals. However, by default, it only scans pictures in the root directory of our choice and doesn&rsquo;t allow us to include its subfolders. To change this, we need to make changes to the Windows 11 system.</p>
<h1 id="install-link_nto1-powershell-script">Install link_Nto1 PowerShell Script</h1>
<p>link_Nto1 is a PowerShell script that helps us create hard/symbolic links to all files of a specified source folder inside a specified destination folder. In the context of this post, we can specify our wallpapers folder (which contains subfolders), and then the script will make symbolic links to all pictures in its subfolders. The script then places those symbolic links in certain folders which we specify, then we can make Windows 11 use that folder instead of our original wallpapers folder.</p>
<p>Begin installing the script by running PowerShell as Administrator:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; Install-Script -Name link_Nto1
</span></span></code></pre></div><p>Then <code>cd</code> to our wallpapers folder:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; cd C:/Users/myuser/wallpapers
</span></span></code></pre></div><p>Create a new folder that will store the generated symbolic links:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; mkdir desktop_slideshow
</span></span></code></pre></div><p>Suppose in the <code>wallpapers</code> folder we have these subfolders: <code>animals</code>, <code>floral</code>, <code>landscapes</code>, then execute the script by passing these arguments:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; link_Nto1.ps1 desktop_slideshow animals,floral,landscapes
</span></span></code></pre></div><p>⚠️ If you get this error:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>link_Nto1.ps1 <span style="color:#960050;background-color:#1e0010">:</span> File C:\Program Files\WindowsPowerShell\Scripts\link_Nto1.ps1 cannot be loaded because running scripts is disabled on this system. <span style="color:#66d9ef">For</span> more information, see about_Execution_Policies at https<span style="color:#960050;background-color:#1e0010">:</span>/go.microsoft.com/fwlink/<span style="color:#66d9ef">?</span>LinkID=<span style="color:#ae81ff">135170</span>. 
</span></span></code></pre></div><p>We need to change our Execution Policy <strong>before</strong> we run the link_Nto1 script. Run this in PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; Set-ExecutionPolicy RemoteSigned
</span></span></code></pre></div><p>After we run the link_Nto1 script, change the Execution Policy back:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>PS&gt; Set-ExecutionPolicy Restricted
</span></span></code></pre></div><h1 id="set-the-windows-11-slideshow-source-to-the-desktop_slideshow-folder">Set the Windows 11 slideshow source to the desktop_slideshow folder</h1>
<ol>
<li>
<p>Go to Settings &gt; Personalization &gt; Background</p>
</li>
<li>
<p>In the &ldquo;Choose a picture album for a slideshow&rdquo;, pick the <code>desktop_slideshow</code> folder we&rsquo;ve just created from prior steps.</p>
</li>
</ol>
<p>Windows 11 will now include all pictures inside our wallpapers folder. Cheers!</p>

</main>

  <footer>
  <script>
  const btnSwitchTheme = document.getElementById("btn-switch-theme")

  function getTheme() {
    const cookies = Object.fromEntries(
      document.cookie.split("; ").map(c => c.split("="))
    );
    return cookies.theme || "light";
  }

  function invertTheme(theme) {
    return theme == "light" ? "dark" : "light"
  }

  function applyTheme(toTheme) {
    btnSwitchTheme.textContent = "Switch to " + invertTheme(toTheme) + " theme"
    document.querySelector("html").style = toTheme == "dark" ? "filter: invert(1);" : ""
    neuralizeChildrenColor("img", toTheme)
    neuralizeChildrenColor(".highlight", toTheme)
  }

  function neuralizeChildrenColor(child, toTheme) {
    console.log("=====> 1 " + toTheme)
    document.querySelectorAll(child).forEach(el => {
      console.log("=====> 2 " + toTheme)
      el.style = toTheme == "dark" ? "filter: invert(1);" : ""
    })
  }

  btnSwitchTheme.addEventListener("click", (event) => {
    const theme = getTheme()
    const newTheme = invertTheme(theme)
    document.cookie = "theme=" + newTheme + ";path=/"
    applyTheme(newTheme)
  })

  applyTheme(getTheme())
</script>
  
  </footer>
  </body>
</html>

